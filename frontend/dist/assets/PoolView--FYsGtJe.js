import{_ as x,r as u,j as E,k as N,a as c,u as B,g as l,f as t,h as f,t as v,F as M,i as S,y as b,m as k,B as w,q as T,b as U,o as n,l as j,w as A}from"./index-DXYm_mhS.js";const L={key:0,class:"pool-view"},R={class:"pool-header"},q={class:"pool-info"},I={key:0,class:"description"},J={class:"meta"},O={class:"pool-actions"},z={class:"posts-grid"},G=["onDragstart","onDrop"],H=["src","alt"],K=["onClick"],Q={class:"post-index"},W={key:0,class:"empty-state"},X={class:"modal"},Y={class:"form-group"},Z={class:"form-group"},ee={class:"modal-actions"},oe={key:1,class:"loading"},te={key:2,class:"error"},se={__name:"PoolView",setup(ae){const y=B(),C=T(),o=u(null),p=u(!0),r=u(!1),i=u({name:"",description:""}),d=u(null);E(async()=>{await h()}),N(()=>y.params.id,h);async function h(){p.value=!0;try{o.value=await c.getPool(y.params.id),i.value={name:o.value.name,description:o.value.description||""}}catch{o.value=null}finally{p.value=!1}}async function P(){try{const s=await c.updatePool(o.value.id,i.value);o.value.name=s.name,o.value.description=s.description,r.value=!1}catch(s){alert("Failed to update pool: "+s.message)}}async function D(){if(confirm("Are you sure you want to delete this pool?"))try{await c.deletePool(o.value.id),C.push("/pools")}catch(s){alert("Failed to delete pool: "+s.message)}}async function $(s){try{await c.removePostFromPool(o.value.id,s),o.value.posts=o.value.posts.filter(e=>e.id!==s),o.value.postCount--}catch(e){alert("Failed to remove post: "+e.message)}}function F(s){d.value=s}async function V(s){if(d.value===null||d.value===s)return;const e=[...o.value.posts],[m]=e.splice(d.value,1);e.splice(s,0,m),o.value.posts=e,d.value=null;try{await fetch(`/api/pools/${o.value.id}/reorder`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({postIds:e.map(a=>a.id)})})}catch(a){console.error("Failed to save order:",a)}}return(s,e)=>{const m=U("router-link");return o.value?(n(),l("div",L,[t("div",R,[t("div",q,[t("h1",null,v(o.value.name),1),o.value.description?(n(),l("p",I,v(o.value.description),1)):f("",!0),t("div",J,v(o.value.postCount)+" posts",1)]),t("div",O,[t("button",{class:"btn btn-secondary",onClick:e[0]||(e[0]=a=>r.value=!0)},"Edit"),t("button",{class:"btn btn-danger",onClick:D},"Delete Pool")])]),t("div",z,[(n(!0),l(M,null,S(o.value.posts,(a,_)=>(n(),l("div",{key:a.id,class:"pool-post",draggable:"true",onDragstart:g=>F(_),onDragover:e[1]||(e[1]=b(()=>{},["prevent"])),onDrop:g=>V(_)},[j(m,{to:`/post/${a.id}`},{default:A(()=>[t("img",{src:a.thumbUrl,alt:a.filename},null,8,H)]),_:2},1032,["to"]),t("button",{class:"remove-btn",onClick:g=>$(a.id)},"Ã—",8,K),t("div",Q,v(_+1),1)],40,G))),128))]),o.value.posts.length===0?(n(),l("div",W," This pool is empty. Add posts from the post view! ")):f("",!0),r.value?(n(),l("div",{key:1,class:"modal-overlay",onClick:e[5]||(e[5]=b(a=>r.value=!1,["self"]))},[t("div",X,[e[8]||(e[8]=t("h2",null,"Edit Pool",-1)),t("div",Y,[e[6]||(e[6]=t("label",null,"Name",-1)),k(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>i.value.name=a)},null,512),[[w,i.value.name]])]),t("div",Z,[e[7]||(e[7]=t("label",null,"Description",-1)),k(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>i.value.description=a),rows:"3"},null,512),[[w,i.value.description]])]),t("div",ee,[t("button",{class:"btn btn-secondary",onClick:e[4]||(e[4]=a=>r.value=!1)},"Cancel"),t("button",{class:"btn",onClick:P},"Save")])])])):f("",!0)])):p.value?(n(),l("div",oe,"Loading...")):(n(),l("div",te,"Pool not found"))}}},ne=x(se,[["__scopeId","data-v-0fdbe8ad"]]);export{ne as default};
